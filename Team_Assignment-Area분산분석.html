<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="2023-2학기 통계자료분석 1조 김재현">
<meta name="dcterms.date" content="2023-12-06">

<title>통계자료분석 팀프로젝트 - Reyemes Affiar</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Team_Assignment6_files/libs/clipboard/clipboard.min.js"></script>
<script src="Team_Assignment6_files/libs/quarto-html/quarto.js"></script>
<script src="Team_Assignment6_files/libs/quarto-html/popper.min.js"></script>
<script src="Team_Assignment6_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Team_Assignment6_files/libs/quarto-html/anchor.min.js"></script>
<link href="Team_Assignment6_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Team_Assignment6_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Team_Assignment6_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Team_Assignment6_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Team_Assignment6_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">통계자료분석 팀프로젝트 - Reyemes Affiar</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>2023-2학기 통계자료분석 1조 김재현 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 6, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">December 21, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 불러오기</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>rawdata <span class="ot">=</span> <span class="fu">read_excel</span>(<span class="st">"./Team_Assignment/Reyeme2.xls"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">=</span> <span class="fu">as.data.frame</span>(rawdata)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>data1<span class="sc">$</span>FirstDate <span class="ot">=</span> <span class="fu">as.Date</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(data1<span class="sc">$</span>FirstDate)),<span class="at">origin=</span><span class="st">"1899-12-30"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in as.Date(as.numeric(as.character(data1$FirstDate)), origin =
"1899-12-30"): NAs introduced by coercion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data1<span class="sc">$</span>RC <span class="ot">=</span> <span class="fu">as.factor</span>(data1<span class="sc">$</span>RC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   456 obs. of  17 variables:
 $ Address  : chr  "73 Allston St" "239 Allston St" "83 Amory St" "107 Antrim St" ...
 $ Unit     : chr  "1" "2" "3" "1" ...
 $ Area     : chr  "CP" "CP" "M" "M" ...
 $ AreaCode : num  4 4 9 9 9 9 9 9 9 9 ...
 $ Price1   : num  109000 127000 123000 219000 199000 ...
 $ Price2   : num  109000 127000 100000 210000 189000 ...
 $ SalePrice: num  106000 125000 95000 206000 175000 ...
 $ FirstDate: Date, format: "1993-07-17" "1993-08-21" ...
 $ CloseDate: POSIXct, format: "1993-10-22" "1993-10-22" ...
 $ Days     : num  97 62 208 159 110 116 160 80 157 123 ...
 $ Interior : num  834 850 730 1460 1630 ...
 $ Bed      : num  2 2 2 3 4 2 2 3 3 3 ...
 $ Bath     : num  1 1 1 2 1 1 1 1 1 1 ...
 $ Rooms    : num  4 5 4 6 8 6 6 5 6 6 ...
 $ Condo    : num  70 100 185 100 50 100 100 163 150 100 ...
 $ Tax      : num  490 923 575 1582 1659 ...
 $ RC       : Factor w/ 2 levels "0","1": 1 2 1 2 2 2 2 1 2 2 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 결측값 존재 확인</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(data1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>결측값 9개 존재.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 결측값 있는 행 확인</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(data1)) <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  27 181 248 254 350 368 383 454 455</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>결측값 중 한개를 제외하곤 모두 UNIT 열 값이다. UNIT는 건물내 특정 주거공간을 나타내는 호수(ex 101호, 102호)이다. Reyem Affiar가 구매하려는 건물의 UNIT는 주어져있지 않기 때문에 Reyem Affiar가 구매하려는 건물 가격을 추정하는데에 UNIT 변수는 사용하지 않을 것으로 예상한다. 나머지 한개의 결측값은 First Date에서 나타났으며, 254행에 있다. FirstDate열은 사용할 예정이므로 254행만 제외한다.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#결측값 있는 행 중 254행 제거</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">=</span> data1[<span class="sc">-</span><span class="dv">254</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data3 <span class="ot">&lt;-</span> <span class="fu">separate</span>(data2, Address, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"AddressNo"</span>, <span class="st">"AddressName"</span>, <span class="st">"Street"</span>), <span class="at">sep =</span> <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: First Date를 연 월 일로 열 나누기</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>data4 <span class="ot">&lt;-</span> <span class="fu">separate</span>(data3, FirstDate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"YearF"</span>, <span class="st">"MonthF"</span>, <span class="st">"DateF"</span>), <span class="at">sep =</span> <span class="st">"-"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="분산분석-saleprice와-area" class="level2">
<h2 class="anchored" data-anchor-id="분산분석-saleprice와-area">분산분석 SalePrice와 Area</h2>
<section id="등분산성-확인" class="level3">
<h3 class="anchored" data-anchor-id="등분산성-확인">등분산성 확인</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggline</span>(data4, <span class="at">x =</span> <span class="st">"Area"</span>, <span class="at">y =</span> <span class="st">"SalePrice"</span>, <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_sd"</span>, <span class="st">"jitter"</span>), </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"지역별 SalePrice"</span>, <span class="at">ylab =</span><span class="st">"SalePrice"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>(<span class="at">base_family =</span> <span class="st">"Noto Sans KR"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/data4%20그래프를%20통한%20등분산성%20확인%20-%20ggline-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>plot상으로 봤을 때, Area별로 등분산성이 지켜지지 않고 있다.</p>
</section>
<section id="잔차가-정규분포인지-확인" class="level3">
<h3 class="anchored" data-anchor-id="잔차가-정규분포인지-확인">잔차가 정규분포인지 확인</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">=</span> <span class="fu">aov</span>(SalePrice <span class="sc">~</span> Area, data4)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: SalePrice
           Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    
Area       15 7.5587e+11 5.0392e+10  7.6168 3.487e-15 ***
Residuals 439 2.9043e+12 6.6158e+09                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Area에 따라 SalePrice가 달라진다는 사실은 확인되었다. (p값 = 3.487e-15 ***)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(M1<span class="sc">$</span>residuals),<span class="at">xlab =</span> <span class="st">""</span>,<span class="at">main =</span> <span class="st">"residual distribution"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/M1%20잔차분포%20확인-정규성%20검증-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>잔차는 오른쪽으로 긴 꼬리분포를 갖고 있다. 대칭성이 있다고 볼수 없다.</p>
<p>그러므로 잔차분포가 정규분포에 가깝다고 판단하기 어렵다.</p>
<p>비대칭도가 심하기 때문에 levene test로 등분산성에대한 검정을 진행한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(M1) <span class="co"># 디폴트 center = median</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in leveneTest.default(y = y, group = group, ...): group coerced to
factor.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
       Df F value    Pr(&gt;F)    
group  15  5.7621 6.854e-11 ***
      439                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>p-value가 <code>6.854e-11 ***</code>로 귀무가설(등분산성을 만족한다.)를 강력하게 기각하고 있다.</p>
<p>비모수검정?</p>
<p>분산 안정화 변환?</p>
<p>outlier 제거?</p>
<p>outlier 제거 후 다시 등분산성 확인</p>
</section>
<section id="outlier-제거" class="level3">
<h3 class="anchored" data-anchor-id="outlier-제거">outlier 제거</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ri <span class="ot">=</span> M1<span class="sc">$</span>residuals</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ri <span class="sc">~</span> data4<span class="sc">$</span>Area, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"residuals"</span>, <span class="at">range=</span> <span class="fl">1.5</span>, <span class="at">boxwex =</span> <span class="fl">0.4</span>) <span class="co"># boxwex는 상자폭을 0.4배 줄이는 옵션</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/boxplot%20확인-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>표준화 혹은 스튜던트화된 잔차는 평균0, 표준편차 1의 분포를 따라야 한다. 그러나 <span class="math inline">\(\pm2\)</span> 이상이라면, mild outlier, <span class="math inline">\(\pm3\)</span> 이상이라면 extreme outlier로 판단한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rstudent</span>(M1))<span class="sc">&gt;</span><span class="fl">1.5</span> <span class="co"># 외적 스튜던트화된 잔차의 절대값이 1.5이상이면 outlier로 판단.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>data5 <span class="ot">=</span> data4[<span class="sc">!</span>outliers,] <span class="co">#outliers가 아닌 행들만 data5에 저장</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="다시-분산분석-및-등분산성-확인" class="level3">
<h3 class="anchored" data-anchor-id="다시-분산분석-및-등분산성-확인">다시 분산분석 및 등분산성 확인</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">=</span> <span class="fu">aov</span>(SalePrice <span class="sc">~</span> Area, data5)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: SalePrice
           Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    
Area       15 3.5174e+11 2.3450e+10  10.131 &lt; 2.2e-16 ***
Residuals 403 9.3277e+11 2.3146e+09                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggline</span>(data5, <span class="at">x =</span> <span class="st">"Area"</span>, <span class="at">y =</span> <span class="st">"SalePrice"</span>, <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_sd"</span>, <span class="st">"jitter"</span>), </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"지역별 SalePrice"</span>, <span class="at">ylab =</span><span class="st">"SalePrice"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>(<span class="at">base_family =</span> <span class="st">"Noto Sans KR"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/data5의%20등분산성%20그래프%20확인%20ggline-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>여전히 Area별로 분포가 크게 다른 것으로 보아 등분산성을 만족하지 않는 것으로 보인다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(M2<span class="sc">$</span>residuals),<span class="at">xlab =</span> <span class="st">""</span>,<span class="at">main =</span> <span class="st">"residual distribution"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/잔차분포%20확인%20-%20정규성%20검증-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>이전과 비교하여 잔차의 분포가 조금 더 정규성을 띄는 것 처럼 보이나 여전히 비대칭에 가깝다.</p>
<p>그러므로 levene test를 이용하여 등분산성을 검정한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(M2) <span class="co"># 디폴트 center = median</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in leveneTest.default(y = y, group = group, ...): group coerced to
factor.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
       Df F value  Pr(&gt;F)  
group  15  1.9053 0.02124 *
      403                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>이전 levene test에 의한 p값(<code>6.854e-11 ***</code>)보다는 p값이 증가하였으나 여전히 낮은 값으로 등분산성을 만족한다는 귀무가설을 기각하고 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ri <span class="ot">=</span> M2<span class="sc">$</span>residuals</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ri <span class="sc">~</span> data5<span class="sc">$</span>Area, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"residuals"</span>, <span class="at">range=</span> <span class="fl">1.5</span>, <span class="at">boxwex =</span> <span class="fl">0.4</span>) <span class="co"># boxwex는 상자폭을 0.4배 줄이는 옵션</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/data5의%20boxplot%20확인-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>여전히 극단값이 존재.</p>
<p>이 극단값을 더 처리하는 방법</p>
<section id="iqr-1.5-기준으로-다시-극단값-처음부터-처리외적-스튜던트-잔차-사용하지-않고" class="level4">
<h4 class="anchored" data-anchor-id="iqr-1.5-기준으로-다시-극단값-처음부터-처리외적-스튜던트-잔차-사용하지-않고">1. IQR 1.5 기준으로 다시 극단값 처음부터 처리(외적 스튜던트 잔차 사용하지 않고)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>Lo <span class="ot">=</span> <span class="fu">quantile</span>(ri,<span class="fl">0.25</span>)<span class="sc">-</span><span class="fl">1.5</span><span class="sc">*</span><span class="fu">IQR</span>(ri)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>Up <span class="ot">=</span> <span class="fu">quantile</span>(ri,<span class="fl">0.75</span>)<span class="sc">+</span><span class="fl">1.5</span><span class="sc">*</span><span class="fu">IQR</span>(ri)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>outliers2 <span class="ot">=</span>ri[(ri<span class="sc">&lt;</span>Lo) <span class="sc">|</span> (ri<span class="sc">&gt;</span>Up)]</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>outliers2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      53       59      143      291      321      327      330      402 
109125.0 129125.0 106571.4 116828.1 123828.1 108828.1 119737.1 114737.1 
     418      420      452      453      455 
133828.1 148828.1 109863.6 113785.4 114737.1 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>outliers2_index <span class="ot">=</span> <span class="fu">which</span>((ri<span class="sc">&lt;</span>Lo) <span class="sc">|</span> (ri<span class="sc">&gt;</span>Up))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>data5M <span class="ot">=</span> data4[<span class="sc">-</span>outliers2_index,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="다시-분산분석m2m-및-등분산성-확인-data5m" class="level4">
<h4 class="anchored" data-anchor-id="다시-분산분석m2m-및-등분산성-확인-data5m">다시 분산분석(M2M) 및 등분산성 확인 (data5M)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>M2M <span class="ot">=</span> <span class="fu">aov</span>(SalePrice <span class="sc">~</span> Area, data5M)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M2M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: SalePrice
           Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    
Area       15 7.5352e+11 5.0235e+10  7.7393 2.083e-15 ***
Residuals 426 2.7651e+12 6.4909e+09                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggline</span>(data5M, <span class="at">x =</span> <span class="st">"Area"</span>, <span class="at">y =</span> <span class="st">"SalePrice"</span>, <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_sd"</span>, <span class="st">"jitter"</span>), </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"지역별 SalePrice"</span>, <span class="at">ylab =</span><span class="st">"SalePrice"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>(<span class="at">base_family =</span> <span class="st">"Noto Sans KR"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/data5M의%20등분산성%20그래프%20확인%20ggline-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(M2M<span class="sc">$</span>residuals),<span class="at">xlab =</span> <span class="st">""</span>,<span class="at">main =</span> <span class="st">"residual distribution"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/data5M(분산분석모형-M2M)%20잔차분포%20확인%20-%20정규성%20검증-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(M2M) <span class="co"># 디폴트 center = median</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in leveneTest.default(y = y, group = group, ...): group coerced to
factor.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
       Df F value    Pr(&gt;F)    
group  15  5.3613 6.229e-10 ***
      426                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>오히려 외적스튜던트화된 잔차를 처리했을때 보다 좋지 않음</p>
</section>
<section id="극단값을-추가로-처리강력한-외적-스튜던트화된-잔차-기준" class="level4">
<h4 class="anchored" data-anchor-id="극단값을-추가로-처리강력한-외적-스튜던트화된-잔차-기준">2. 극단값을 추가로 처리(강력한 외적 스튜던트화된 잔차 기준)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>outliers3 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rstudent</span>(M1))<span class="sc">&gt;</span><span class="dv">1</span> <span class="co"># 외적 스튜던트화된 잔차의 절대값이 1이상이면 outlier로 판단.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>data5MM <span class="ot">=</span> data4[<span class="sc">!</span>outliers3,] <span class="co">#outliers가 아닌 행들만 data5MM에 저장</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data5mm-다시-분산분석-및-등분산성-확인" class="level3">
<h3 class="anchored" data-anchor-id="data5mm-다시-분산분석-및-등분산성-확인">data5MM 다시 분산분석 및 등분산성 확인</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>M2MM <span class="ot">=</span> <span class="fu">aov</span>(SalePrice <span class="sc">~</span> Area, data5MM)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M2MM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: SalePrice
           Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    
Area       15 2.7482e+11 1.8321e+10  14.221 &lt; 2.2e-16 ***
Residuals 350 4.5091e+11 1.2883e+09                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggline</span>(data5MM, <span class="at">x =</span> <span class="st">"Area"</span>, <span class="at">y =</span> <span class="st">"SalePrice"</span>, <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_sd"</span>, <span class="st">"jitter"</span>), </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"지역별 SalePrice"</span>, <span class="at">ylab =</span><span class="st">"SalePrice"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>(<span class="at">base_family =</span> <span class="st">"Noto Sans KR"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/data5MM의%20등분산성%20그래프%20확인%20ggline-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>여전히 Area별로 분포가 다른 것이 보이나 상당히 비슷해진것으로 보인다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(M2MM<span class="sc">$</span>residuals),<span class="at">xlab =</span> <span class="st">""</span>,<span class="at">main =</span> <span class="st">"residual distribution"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/M2MM의%20잔차분포%20확인%20-%20정규성%20검증-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>이전과 비교하여 잔차의 분포가 조금 더 정규성을 띄는 것 처럼 보이나 여전히 비대칭에 가깝다.</p>
<p>그러므로 levene test를 이용하여 등분산성을 검정한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(M2MM) <span class="co"># 디폴트 center = median</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in leveneTest.default(y = y, group = group, ...): group coerced to
factor.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
       Df F value  Pr(&gt;F)  
group  15   1.638 0.06205 .
      350                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>M2의 levene test에 의한 p값(<code>0.02124</code>)보다는 p값이 증가하였으나 여전히 낮은 값으로 간신히 등분산성을 만족한다는 귀무가설을 기각하지 않고 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>riMM <span class="ot">=</span> M2MM<span class="sc">$</span>residuals</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(riMM <span class="sc">~</span> data5MM<span class="sc">$</span>Area, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"residuals"</span>, <span class="at">range=</span> <span class="fl">1.5</span>, <span class="at">boxwex =</span> <span class="fl">0.4</span>) <span class="co"># boxwex는 상자폭을 0.4배 줄이는 옵션</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/data5MM의%20boxplot%20확인-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>여전히 극단값이 몇개 확인된다.</p>
<p>외적 스튜던트화된 잔차를 활용한 극단값 제거는 현재 조건(1이상)이 최대라 할 수 있다.</p>
<p>여기서 추가로 outlier를 제거해보면</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>Lo <span class="ot">=</span> <span class="fu">quantile</span>(riMM,<span class="fl">0.25</span>)<span class="sc">-</span><span class="fl">1.5</span><span class="sc">*</span><span class="fu">IQR</span>(riMM)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>Up <span class="ot">=</span> <span class="fu">quantile</span>(riMM,<span class="fl">0.75</span>)<span class="sc">+</span><span class="fl">1.5</span><span class="sc">*</span><span class="fu">IQR</span>(riMM)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>outliersMM <span class="ot">=</span>riMM[(riMM<span class="sc">&lt;</span>Lo) <span class="sc">|</span> (riMM<span class="sc">&gt;</span>Up)]</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>outliersMM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      53       56      327 
105500.0  95500.0 106401.6 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>outliersMM_index <span class="ot">=</span> <span class="fu">which</span>((riMM<span class="sc">&lt;</span>Lo) <span class="sc">|</span> (riMM<span class="sc">&gt;</span>Up))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>data5MMM <span class="ot">=</span> data5MM[<span class="sc">-</span>outliersMM_index,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="다시-분산분석m2mmm-및-등분산성-확인-data5mmm" class="level4">
<h4 class="anchored" data-anchor-id="다시-분산분석m2mmm-및-등분산성-확인-data5mmm">다시 분산분석(M2MMM) 및 등분산성 확인 (data5MMM)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>M2MMM <span class="ot">=</span> <span class="fu">aov</span>(SalePrice <span class="sc">~</span> Area, data5MMM)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M2MMM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: SalePrice
           Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    
Area       15 1.9869e+11 1.3246e+10  11.072 &lt; 2.2e-16 ***
Residuals 347 4.1512e+11 1.1963e+09                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggline</span>(data5MMM, <span class="at">x =</span> <span class="st">"Area"</span>, <span class="at">y =</span> <span class="st">"SalePrice"</span>, <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_sd"</span>, <span class="st">"jitter"</span>), </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"지역별 SalePrice"</span>, <span class="at">ylab =</span><span class="st">"SalePrice"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>(<span class="at">base_family =</span> <span class="st">"Noto Sans KR"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/data5MMM의%20등분산성%20그래프%20확인%20ggline-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(M2MMM<span class="sc">$</span>residuals),<span class="at">xlab =</span> <span class="st">""</span>,<span class="at">main =</span> <span class="st">"residual distribution"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/data5MMM(분산분석모형-M2MMM)%20잔차분포%20확인%20-%20정규성%20검증-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>이정도면 거의 정규분포로 봐도 무방할 듯 하다. levene test와 bartlett test를 사용하여 등분산성 검정을 확인해보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(M2MMM) <span class="co"># 디폴트 center = median</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in leveneTest.default(y = y, group = group, ...): group coerced to
factor.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
       Df F value   Pr(&gt;F)   
group  15  2.2456 0.005093 **
      347                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(SalePrice <span class="sc">~</span> Area, data5MMM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  SalePrice by Area
Bartlett's K-squared = 29.654, df = 15, p-value = 0.01323</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>data5MM은 무려 데이터를 93개 즉, 전체 데이터의 20%를 극단값으로 처리하여 제거했지만 등분산성을 만족하지 못하였다. outlier 제거가 아닌 다른 방식을 찾아야 한다. 분산 안정화 변환 혹은 비모수검정을 사용하는 것이 좋을 듯 하다.</p>
</div>
</div>
</section>
</section>
<section id="분산안정화-변환" class="level3">
<h3 class="anchored" data-anchor-id="분산안정화-변환">분산안정화 변환</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slp</span>(M1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/slp()-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Suggested power transformation:  -0.9050363 </code></pre>
</div>
</div>
<p>결과 : <code>Suggested power transformation:  -0.9050363</code></p>
<p>역수변환</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>data5T <span class="ot">=</span> data4</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>data5T<span class="sc">$</span>RSalePrice <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>data4<span class="sc">$</span>SalePrice</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>M2T <span class="ot">=</span> <span class="fu">aov</span>(RSalePrice <span class="sc">~</span> Area, data5T)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M2T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: RSalePrice
           Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    
Area       15 5.6470e-10 3.7647e-11   5.655 1.216e-10 ***
Residuals 439 2.9226e-09 6.6570e-12                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggline</span>(data5T, <span class="at">x =</span> <span class="st">"Area"</span>, <span class="at">y =</span> <span class="st">"RSalePrice"</span>, <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_sd"</span>, <span class="st">"jitter"</span>), </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"지역별 SalePrice의 역수"</span>, <span class="at">ylab =</span><span class="st">"1/SalePrice"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>(<span class="at">base_family =</span> <span class="st">"Noto Sans KR"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/data5T의%20등분산성%20그래프%20확인%20ggline-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>여전히 Area별로 분포가 크게 다른 것으로 보아 등분산성을 만족하지 않는 것으로 보인다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(M2T<span class="sc">$</span>residuals),<span class="at">xlab =</span> <span class="st">""</span>,<span class="at">main =</span> <span class="st">"residual distribution"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/M2T%20잔차분포%20확인%20-%20정규성%20검증-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>이전과 비교하여 잔차의 분포가 조금 더 정규성을 띄는 것 처럼 보이나 여전히 비대칭에 가깝다.</p>
<p>그러므로 levene test를 이용하여 등분산성을 검정한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(M2T) <span class="co"># 디폴트 center = median</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in leveneTest.default(y = y, group = group, ...): group coerced to
factor.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
       Df F value    Pr(&gt;F)    
group  15  3.0449 0.0001066 ***
      439                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>여전히 등분산성을 만족하지 못하고 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(RSalePrice <span class="sc">~</span> Area, data5T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  RSalePrice by Area
Bartlett's K-squared = 57.997, df = 15, p-value = 5.554e-07</code></pre>
</div>
</div>
<p>여전히 등분산성을 만족하지 못하고 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>riT <span class="ot">=</span> M2T<span class="sc">$</span>residuals</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(riT <span class="sc">~</span> data5T<span class="sc">$</span>Area, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"residuals"</span>, <span class="at">range=</span> <span class="fl">1.5</span>, <span class="at">boxwex =</span> <span class="fl">0.4</span>) <span class="co"># boxwex는 상자폭을 0.4배 줄이는 옵션</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/data5T의%20boxplot%20확인-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>극단값이 몇개 확인된다.</p>
<p>outlier를 제거해보면</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>Lo <span class="ot">=</span> <span class="fu">quantile</span>(riT,<span class="fl">0.25</span>)<span class="sc">-</span><span class="fl">1.5</span><span class="sc">*</span><span class="fu">IQR</span>(riT)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>Up <span class="ot">=</span> <span class="fu">quantile</span>(riT,<span class="fl">0.75</span>)<span class="sc">+</span><span class="fl">1.5</span><span class="sc">*</span><span class="fu">IQR</span>(riT)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>outliersT <span class="ot">=</span>riT[(riT<span class="sc">&lt;</span>Lo) <span class="sc">|</span> (riT<span class="sc">&gt;</span>Up)]</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>outliersT</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           16           115           163           177           179 
 6.316949e-06  6.682245e-06  6.713274e-06  6.240938e-06  6.034722e-06 
          227           275           297           303           382 
-6.992697e-06  6.622712e-06  6.519875e-06  6.519875e-06  1.043355e-05 
          410           412 
 9.675781e-06  7.631255e-06 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>outliersT_index <span class="ot">=</span> <span class="fu">which</span>((riT<span class="sc">&lt;</span>Lo) <span class="sc">|</span> (riT<span class="sc">&gt;</span>Up))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>data5TT <span class="ot">=</span> data5T[<span class="sc">-</span>outliersT_index,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="다시-분산분석m2tt-및-등분산성-확인-data5tt" class="level4">
<h4 class="anchored" data-anchor-id="다시-분산분석m2tt-및-등분산성-확인-data5tt">다시 분산분석(M2TT) 및 등분산성 확인 (data5TT)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>M2TT <span class="ot">=</span> <span class="fu">aov</span>(RSalePrice <span class="sc">~</span> Area, data5TT)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M2TT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: RSalePrice
           Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    
Area       15 7.3921e-10 4.9281e-11  9.4471 &lt; 2.2e-16 ***
Residuals 427 2.2274e-09 5.2160e-12                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggline</span>(data5TT, <span class="at">x =</span> <span class="st">"Area"</span>, <span class="at">y =</span> <span class="st">"RSalePrice"</span>, <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_sd"</span>, <span class="st">"jitter"</span>), </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"지역별 1/SalePrice"</span>, <span class="at">ylab =</span><span class="st">"1/SalePrice"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>(<span class="at">base_family =</span> <span class="st">"Noto Sans KR"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/data5TT의%20등분산성%20그래프%20확인%20ggline-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(M2TT<span class="sc">$</span>residuals),<span class="at">xlab =</span> <span class="st">""</span>,<span class="at">main =</span> <span class="st">"residual distribution"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Team_Assignment6_files/figure-html/data5TT(분산분석모형-M2TT)%20잔차분포%20확인%20-%20정규성%20검증-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>이정도면 거의 정규분포로 봐도 무방할 듯 하다. levene test와 bartlett test를 사용하여 등분산성 검정을 확인해보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(M2TT) <span class="co"># 디폴트 center = median</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in leveneTest.default(y = y, group = group, ...): group coerced to
factor.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
       Df F value    Pr(&gt;F)    
group  15  2.7734 0.0004093 ***
      427                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(RSalePrice <span class="sc">~</span> Area, data5TT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  RSalePrice by Area
Bartlett's K-squared = 41.256, df = 15, p-value = 0.0002923</code></pre>
</div>
</div>
</section>
<section id="비모수검정" class="level4">
<h4 class="anchored" data-anchor-id="비모수검정">비모수검정</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(SalePrice <span class="sc">~</span> Area, data4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  SalePrice by Area
Kruskal-Wallis chi-squared = 57.8, df = 15, p-value = 6.001e-07</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(data4<span class="sc">$</span>SalePrice, data4<span class="sc">$</span>Area,<span class="at">p.adjust.method =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum test with continuity correction 

data:  data4$SalePrice and data4$Area 

   AG      AH      C       CP      E       FP      HS      K       M      
AH 0.39796 -       -       -       -       -       -       -       -      
C  0.01026 0.09123 -       -       -       -       -       -       -      
CP 0.00239 0.01605 0.85894 -       -       -       -       -       -      
E  0.01089 0.00013 0.03349 6.6e-05 -       -       -       -       -      
FP 0.16648 0.60439 0.26667 0.37444 0.16270 -       -       -       -      
HS 0.16847 0.26644 0.63589 0.43293 2.9e-05 0.78660 -       -       -      
K  0.29239 0.10885 0.29559 0.05558 0.05489 0.52979 0.11739 -       -      
M  0.26764 0.69331 0.20515 0.03038 8.4e-07 0.76046 0.32603 0.06485 -      
N  0.08886 0.20826 0.96347 0.81300 0.00235 0.47059 0.66540 0.13448 0.27736
NW 0.58333 0.89969 0.41270 0.08597 0.03534 0.85714 0.47393 0.47538 0.75452
PS 0.00118 0.00418 1.00000 0.47670 0.00028 0.17945 0.23081 0.04919 0.01161
RA 0.48223 0.80776 0.10737 0.00936 7.5e-05 0.69392 0.17251 0.16112 0.46635
RS 0.08666 0.19673 0.53044 0.68752 0.00038 1.00000 0.70784 0.08005 0.26972
SH 0.00255 0.00215 0.17143 0.02893 0.00105 0.14286 0.00602 0.00739 0.00201
W  0.96918 0.36161 0.06074 0.00256 0.00132 0.38238 0.06611 0.20768 0.13625
   N       NW      PS      RA      RS      SH     
AH -       -       -       -       -       -      
C  -       -       -       -       -       -      
CP -       -       -       -       -       -      
E  -       -       -       -       -       -      
FP -       -       -       -       -       -      
HS -       -       -       -       -       -      
K  -       -       -       -       -       -      
M  -       -       -       -       -       -      
N  -       -       -       -       -       -      
NW 0.34201 -       -       -       -       -      
PS 0.55319 0.05263 -       -       -       -      
RA 0.12627 1.00000 0.00293 -       -       -      
RS 0.88994 0.40680 0.40668 0.16726 -       -      
SH 0.02134 0.01732 0.05155 0.00169 0.01835 -      
W  0.05127 0.71275 0.00096 0.42609 0.06093 0.00125

P value adjustment method: none </code></pre>
</div>
</div>
<p>비모수 검정을 사용했지만 괜찮은 결과를 얻지 못했다. 결국 E 만 다른 그룹과 다르다는 결과를 얻었을 뿐이다.</p>
<p>외적 스튜던트화된 잔차(1.5이상)를 사용하여 outlier를 제거한 data5를 이용한 비모수 검정을 진행해보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(SalePrice <span class="sc">~</span> Area, data4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  SalePrice by Area
Kruskal-Wallis chi-squared = 57.8, df = 15, p-value = 6.001e-07</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(data5<span class="sc">$</span>SalePrice, data5<span class="sc">$</span>Area,<span class="at">p.adjust.method =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum test with continuity correction 

data:  data5$SalePrice and data5$Area 

   AG      AH      C       CP      E       FP      HS      K       M      
AH 0.30936 -       -       -       -       -       -       -       -      
C  0.01026 0.10123 -       -       -       -       -       -       -      
CP 0.00239 0.02280 0.85894 -       -       -       -       -       -      
E  0.00024 2.6e-07 0.00289 2.7e-07 -       -       -       -       -      
FP 0.16648 0.64404 0.26667 0.37444 0.02927 -       -       -       -      
HS 0.02659 0.03687 0.91533 0.98031 1.5e-08 0.54269 -       -       -      
K  0.16264 0.03326 0.15145 0.01705 0.02100 0.38216 0.00391 -       -      
M  0.21949 0.75721 0.21960 0.03884 3.0e-09 0.79020 0.01842 0.01801 -      
N  0.01079 0.04669 0.79804 0.67308 4.3e-06 0.26667 0.62112 0.01145 0.05345
NW 0.58333 0.81221 0.41270 0.08597 0.00195 0.85714 0.20187 0.33036 0.69841
PS 0.00118 0.00561 1.00000 0.47670 2.3e-06 0.17945 0.57361 0.01284 0.01420
RA 0.48223 0.63901 0.10737 0.00936 5.9e-07 0.69392 0.00871 0.09202 0.36295
RS 0.08666 0.24735 0.53044 0.68752 4.1e-06 1.00000 0.72941 0.02190 0.31359
SH 0.00255 0.00239 0.17143 0.02893 0.00046 0.14286 0.01031 0.00571 0.00215
W  0.96918 0.25628 0.06074 0.00256 5.6e-05 0.38238 0.00188 0.11601 0.09357
   N       NW      PS      RA      RS      SH     
AH -       -       -       -       -       -      
C  -       -       -       -       -       -      
CP -       -       -       -       -       -      
E  -       -       -       -       -       -      
FP -       -       -       -       -       -      
HS -       -       -       -       -       -      
K  -       -       -       -       -       -      
M  -       -       -       -       -       -      
N  -       -       -       -       -       -      
NW 0.12628 -       -       -       -       -      
PS 1.00000 0.05263 -       -       -       -      
RA 0.01423 1.00000 0.00293 -       -       -      
RS 0.64669 0.40680 0.40668 0.16726 -       -      
SH 0.04076 0.01732 0.05155 0.00169 0.01835 -      
W  0.00529 0.71275 0.00096 0.42609 0.06093 0.00125

P value adjustment method: none </code></pre>
</div>
</div>
<p>위 결과를 이용하면</p>
<p>그룹은 다음과 같이 묶을 수 있다.</p>
<p>Zone1 - E Zone2 - C,CP,PS,SH Zone3 - AG,AH,FP,HS,K,M,N,NW,RA,RS,W</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>